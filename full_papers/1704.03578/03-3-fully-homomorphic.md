# Section 3.3: Fully Homomorphic Encryption Schemes
## القسم 3.3: مخططات التشفير المتماثل الكامل

**Section:** Homomorphic Encryption Schemes - Fully Homomorphic (FHE)
**Translation Quality:** 0.90
**Glossary Terms Used:** homomorphic encryption (تشفير متماثل), encryption (تشفير), ciphertext (نص مشفر), plaintext (نص واضح), lattice-based (قائم على الشبكات), bootstrapping (تمهيد ذاتي), noise (ضوضاء), decryption (فك تشفير), security (أمان), circuit (دائرة)

---

### English Version

Fully Homomorphic Encryption (FHE) represents the holy grail of homomorphic encryption research: the ability to perform **arbitrary computations on encrypted data** without any limitations on the type or number of operations. Unlike PHE (single operation type) and SWHE (bounded computation depth), FHE enables evaluation of any computable function while preserving data confidentiality.

**Formal Definition**: An FHE scheme supports both homomorphic addition and multiplication for an **unlimited number of operations**:
- $E(m_1) + E(m_2) = E(m_1 + m_2)$ for any number of additions
- $E(m_1) \times E(m_2) = E(m_1 \times m_2)$ for any number of multiplications

Since any computable function can be represented as a Boolean or arithmetic circuit composed of additions and multiplications, FHE enables evaluation of arbitrary functions on encrypted data.

### Gentry's Revolutionary Breakthrough (2009)

Craig Gentry's 2009 doctoral thesis presented the first practical construction of FHE, solving a problem that had remained open for over 30 years since Rivest, Adleman, and Dertouzos first proposed the concept in 1978.

#### The Core Innovation: Bootstrapping

**The Noise Problem**: As discussed in SWHE, homomorphic operations introduce and accumulate noise in ciphertexts. In traditional schemes, this noise eventually renders decryption impossible, limiting computation depth.

**Gentry's Solution**: **Bootstrapping** - a technique to "refresh" noisy ciphertexts by homomorphically evaluating the decryption function itself.

**How Bootstrapping Works**:

1. **Start with a noisy ciphertext** $c$ encrypting message $m$ under key $sk_1$
2. **Encrypt the secret key**: Create $E_{sk_2}(sk_1)$ - an encryption of the first secret key under a second key
3. **Homomorphic decryption**: Evaluate the decryption circuit homomorphically:
   $$c' = \text{Decrypt}_{sk_1}(c) \text{ evaluated homomorphically using } E_{sk_2}(sk_1)$$
4. **Result**: A fresh ciphertext $c'$ encrypting the same message $m$ under key $sk_2$, but with **small noise**

**Key Insight**: If the decryption circuit's complexity is sufficiently small (i.e., it can be evaluated before noise overwhelms the scheme), then bootstrapping becomes self-sustaining—each refresh operation can be followed by another, enabling unlimited computation depth.

#### Squashing: Making Bootstrapping Possible

For bootstrapping to work, the decryption circuit must be simple enough to evaluate homomorphically with the available noise budget. Gentry introduced **squashing**—a technique to reduce decryption circuit complexity:

**Squashing Technique**:
- Select specific vectors $v_i$ whose sum equals the secret key's multiplicative inverse
- Augment public key with encrypted hint vectors
- Modified decryption uses these hints to reduce circuit depth
- Trade-off: Increased public key size for simpler decryption

**Foundation**: Sparse Subset Sum Problem (SSSP) - a computationally hard problem that provides security for the squashing technique.

### The Four Major FHE Families

Since Gentry's breakthrough, FHE research has evolved into four distinct families, each with different mathematical foundations and performance characteristics.

---

## 1. Ideal Lattice-Based FHE (Gentry 2009)

**Mathematical Foundation**: Based on ideal lattices—algebraic structures represented as lattices in high-dimensional spaces.

**Key Concepts**:
- **Lattice**: A discrete subgroup of $\mathbb{R}^n$ generated by basis vectors
- **Ideal**: A special subset of a ring closed under multiplication
- **Hard Problem**: Finding short vectors in lattices (SVP, CVP) or distinguishing random lattices from ideal-structured ones

**Gentry's Original Construction**:
1. Start with a SWHE scheme based on ideal lattices
2. Apply squashing to reduce decryption complexity
3. Enable bootstrapping to achieve full homomorphism

**Operations**:
- **Addition**: Vector addition in the lattice
- **Multiplication**: Tensor product or ideal multiplication
- **Bootstrapping**: Homomorphic evaluation of decryption circuit

**Advantages**:
- Strong security foundations based on worst-case lattice problems
- Post-quantum security (resistant to quantum attacks)
- First practical FHE construction

**Limitations**:
- High computational complexity (decryption circuit depth)
- Large key sizes and ciphertext expansion
- Complex mathematical prerequisites
- Impractical for immediate real-world deployment

**Security Basis**: Hardness of the Shortest Vector Problem (SVP) and Closest Vector Problem (CVP) in ideal lattices.

---

## 2. Integer-Based FHE (van Dijk et al. 2010)

**Mathematical Foundation**: Based on arithmetic over integers rather than lattice structures, making it conceptually simpler.

**Core Idea**: Encrypt a message $m$ by hiding it in noise around a large integer multiple of a secret $p$:
$$c = m + 2r + pq$$

where:
- $p$ is the secret key (a large prime)
- $m$ is the message (small integer)
- $r$ is random noise
- $q$ is a large random integer

**Decryption**: $(c \mod p) \mod 2$ recovers the message bit.

**Homomorphic Operations**:
- **Addition**: $c_1 + c_2$ preserves the structure
- **Multiplication**: $c_1 \times c_2$ also works (with noise growth)

**Security Basis**: Approximate Greatest Common Divisor (AGCD) problem—given many noisy multiples of $p$, it's hard to recover $p$.

**Key Schemes**:

### DGHV Scheme (van Dijk, Gentry, Halevi, Vaikuntanathan 2010)
- Symmetric-key variant for simplicity
- Original public key size: $O(\lambda^{10})$ - extremely large
- Bootstrapping enables full homomorphism

### Improved Variants

**Batching FHE (Smart & Vercauteren 2012)**:
- **Innovation**: Pack multiple plaintext bits into a single ciphertext
- Enables SIMD (Single Instruction, Multiple Data) style operations
- Dramatically improves throughput for parallel computations

**Compressed Public Key (Coron et al. 2011-2013)**:
- Reduces public key from $O(\lambda^{10})$ to $O(\lambda^7)$ and eventually $O(\lambda^3)$
- Uses lattice techniques to compress the key
- Makes the scheme more practical

**Advantages**:
- Conceptually simpler than lattice-based schemes (no complex algebraic structures)
- Easier to understand and implement
- Good for educational purposes

**Limitations**:
- Originally very large public keys (though improved)
- Still slower than lattice-based schemes
- Security reductions less tight than ideal lattice schemes

---

## 3. LWE-Based FHE (Brakerski & Vaikuntanathan 2011)

**Mathematical Foundation**: Learning With Errors (LWE) and its ring variant (RLWE) problems.

**LWE Problem**: Given samples $(a_i, b_i = \langle a_i, s \rangle + e_i)$ where $s$ is a secret vector and $e_i$ is small error, recover $s$.

**Ring-LWE (RLWE)**: LWE over polynomial rings for efficiency—operations on polynomials modulo $x^n + 1$.

**Key Innovation**: **Re-linearization** technique to control ciphertext expansion.

### Major LWE-Based Schemes

#### BGV Scheme (Brakerski, Gentry, Vaikuntanathan 2012)
- **Second generation** FHE with significantly improved efficiency
- **Modulus switching**: Reduce ciphertext modulus after operations to control noise
- **Key switching**: Change encryption keys without full decryption
- **Leveled FHE**: Can perform bounded-depth circuits without bootstrapping (more efficient)

**Noise Growth**: Linear rather than exponential (major improvement)

#### Scale-Invariant FHE (Brakerski 2012)
- Noise growth independent of ciphertext modulus
- Further efficiency improvements
- Foundation for practical implementations

#### FV Scheme (Fan & Vercauteren 2012)
- RLWE-based with scale-invariant properties
- Optimized for efficient multiplication
- Widely implemented in libraries (SEAL, PALISADE)

#### GSW Scheme (Gentry, Sahai, Waters 2013)
- **Approximate eigenvector method**: Replaces re-linearization
- Simpler analysis and better asymptotic efficiency
- Enables advanced techniques like attribute-based FHE

**Advantages**:
- Strong security reductions to standard problems
- Efficient implementations (fastest FHE schemes)
- Flexible: leveled FHE (without bootstrapping) or pure FHE (with bootstrapping)
- Post-quantum secure
- Most widely deployed in practice

**Limitations**:
- Still computationally intensive (though vastly improved)
- Ciphertext expansion (though manageable)
- Parameter selection requires expertise

**Security Basis**: Hardness of (Ring-)LWE problem, which has strong worst-case to average-case reductions.

---

## 4. NTRU-Like FHE (López-Alt et al. 2012)

**Mathematical Foundation**: Extends the classical NTRU encryption scheme (Hoffstein, Pipher, Silverman 1996) to support homomorphic operations.

**Classical NTRU**: Based on polynomial rings modulo $x^n - 1$ or $x^n + 1$.
- **Key generation**: Secret keys $f, g$ are small polynomials; public key $h = g/f \mod q$
- **Encryption**: $c = r \cdot h + m \mod q$
- **Decryption**: $m = (f \cdot c \mod q) \mod p$

**Homomorphic Extension**:
- Modify NTRU to support addition and multiplication on ciphertexts
- Control noise growth through careful parameter selection
- Enable limited homomorphic operations (SWHE level) or full FHE with bootstrapping

### Key NTRU-Like Schemes

#### LTV Scheme (López-Alt, Tromer, Vaikuntanathan 2012)
- **Major innovation**: **Multi-key FHE**
- Enables homomorphic operations on ciphertexts encrypted under **different keys**
- Allows multiple parties to contribute encrypted data for joint computation
- Requires joint secret key for final decryption

**Use Case**: Cloud computing where multiple clients upload encrypted data, server computes on all data homomorphically, parties jointly decrypt results.

#### YASHE Scheme (Yet Another Somewhat Homomorphic Encryption)
- Optimized NTRU-based construction
- Focus on efficiency for practical deployment
- Simplified parameter selection

**Advantages**:
- **Efficiency**: NTRU operations (polynomial multiplication) are fast
- **Compact keys and ciphertexts**: Smaller than many lattice-based schemes
- **Standardization potential**: NTRU is a NIST post-quantum candidate
- **Easier implementation**: Less complex than ideal lattice schemes
- **Multi-key capability**: Unique among FHE families

**Limitations**:
- Security foundations less studied than LWE-based schemes
- Fewer optimizations and implementations compared to BGV/BFV
- Multi-key FHE adds complexity and overhead

**Security Basis**: NTRU problem—recovering secret key from public key polynomial is computationally hard.

---

### Comparison of FHE Families

| Family | Foundation | Key Schemes | Efficiency | Security Basis | Special Features |
|--------|-----------|-------------|------------|----------------|------------------|
| Ideal Lattice | Ideal lattices | Gentry 2009 | Low | SVP, CVP | First FHE; squashing |
| Integer-Based | AGCD | DGHV, Batching | Medium | AGCD | Conceptually simple |
| LWE-Based | (R)LWE | BGV, BFV, GSW | High | (R)LWE | Most practical; leveled FHE |
| NTRU-Like | NTRU | LTV, YASHE | Medium-High | NTRU problem | Multi-key capability |

### Key Optimizations and Improvements

#### 1. Modulus Switching (Brakerski, Vaikuntanathan 2011)
- Technique to reduce ciphertext modulus after operations
- Controls noise growth by "scaling down" ciphertexts
- Eliminates need for SSSP assumption
- Enables more operations before bootstrapping

#### 2. Key Switching (Brakerski, Vaikuntanathan 2011)
- Change encryption key without decryption
- Essential for homomorphic multiplication (dimension reduction)
- Allows ciphertext re-encryption under different keys

#### 3. Re-linearization
- After multiplication, ciphertext size grows
- Re-linearization reduces ciphertext back to standard size
- Uses evaluation keys (part of public key)
- Critical for maintaining efficiency

#### 4. Batching / SIMD Techniques
- Pack multiple plaintexts into one ciphertext
- Single homomorphic operation affects all packed values
- Massive parallelization for data-parallel computations
- Throughput improvements of orders of magnitude

#### 5. Leveled FHE
- Support circuits of predetermined depth $L$ without bootstrapping
- Much more efficient than pure FHE with bootstrapping
- Sufficient for many practical applications
- BGV and BFV schemes excel at leveled FHE

#### 6. Approximate Eigenvector Method (Gentry et al. 2013)
- Alternative to re-linearization in GSW scheme
- Simpler analysis and better asymptotic efficiency
- Enables new cryptographic primitives

### Practical Implementations and Performance

**Software Libraries**:
- **HElib** (IBM): Optimized BGV implementation
- **SEAL** (Microsoft): Efficient BFV and CKKS implementations
- **PALISADE**: Comprehensive FHE library with multiple schemes
- **TFHE**: Fast bootstrapping-based FHE for binary circuits

**Hardware Acceleration**:
- **GPU implementations**: Leverage massive parallelism for polynomial operations
- **FPGA designs**: Custom hardware for NTT (Number Theoretic Transform)
- **ASIC proposals**: Specialized chips for FHE operations

**Performance Metrics (approximate, varies by parameters)**:
- Single homomorphic multiplication: milliseconds to seconds
- Bootstrapping: seconds to minutes (major bottleneck)
- Throughput with batching: thousands of operations per second

### Transition to Practice: Section 4 Preview

While FHE schemes have made tremendous theoretical and practical progress, significant challenges remain for widespread deployment:
- **Computational overhead**: 4-6 orders of magnitude slower than plaintext computation
- **Parameter selection**: Requires cryptographic expertise
- **Memory requirements**: Large keys and ciphertexts
- **Standardization**: Ongoing efforts to standardize schemes and parameters

Section 4 will examine implementations, optimizations, and recent improvements that are making FHE increasingly practical for real-world privacy-preserving applications.

---

### النسخة العربية

يمثل التشفير المتماثل الكامل (FHE) الهدف الأسمى لأبحاث التشفير المتماثل: القدرة على إجراء **عمليات حسابية تعسفية على البيانات المشفرة** دون أي قيود على نوع أو عدد العمليات. على عكس PHE (نوع عملية واحدة) وSWHE (عمق حساب محدود)، يمكّن FHE من تقييم أي دالة قابلة للحوسبة مع الحفاظ على سرية البيانات.

**التعريف الرسمي**: يدعم مخطط FHE كلاً من الجمع والضرب المتماثلين لعدد **غير محدود من العمليات**:
- $E(m_1) + E(m_2) = E(m_1 + m_2)$ لأي عدد من عمليات الجمع
- $E(m_1) \times E(m_2) = E(m_1 \times m_2)$ لأي عدد من عمليات الضرب

نظراً لأن أي دالة قابلة للحوسبة يمكن تمثيلها كدائرة منطقية أو حسابية مكونة من عمليات الجمع والضرب، يمكّن FHE من تقييم دوال تعسفية على البيانات المشفرة.

### الاختراق الثوري لجينتري (2009)

قدمت أطروحة الدكتوراه لكريج جينتري في عام 2009 أول بناء عملي لـ FHE، حلاً لمشكلة ظلت مفتوحة لأكثر من 30 عاماً منذ أن اقترح ريفست وأدلمان وديرتوزوس المفهوم لأول مرة في عام 1978.

#### الابتكار الأساسي: التمهيد الذاتي

**مشكلة الضوضاء**: كما نوقش في SWHE، تُدخل العمليات المتماثلة الضوضاء وتتراكمها في النصوص المشفرة. في المخططات التقليدية، تجعل هذه الضوضاء في النهاية فك التشفير مستحيلاً، مما يحد من عمق الحساب.

**حل جينتري**: **التمهيد الذاتي (Bootstrapping)** - تقنية "لتجديد" النصوص المشفرة المشوشة من خلال تقييم دالة فك التشفير نفسها بشكل متماثل.

**كيف يعمل التمهيد الذاتي**:

1. **ابدأ بنص مشفر مشوش** $c$ يشفر رسالة $m$ تحت مفتاح $sk_1$
2. **شفّر المفتاح السري**: أنشئ $E_{sk_2}(sk_1)$ - تشفير للمفتاح السري الأول تحت مفتاح ثانٍ
3. **فك تشفير متماثل**: قيّم دائرة فك التشفير بشكل متماثل:
   $$c' = \text{Decrypt}_{sk_1}(c) \text{ مُقيّم بشكل متماثل باستخدام } E_{sk_2}(sk_1)$$
4. **النتيجة**: نص مشفر جديد $c'$ يشفر نفس الرسالة $m$ تحت مفتاح $sk_2$، ولكن مع **ضوضاء صغيرة**

**الفكرة الرئيسية**: إذا كان تعقيد دائرة فك التشفير صغيراً بما يكفي (أي يمكن تقييمه قبل أن تطغى الضوضاء على المخطط)، فإن التمهيد الذاتي يصبح مستداماً ذاتياً - يمكن أن تتبع كل عملية تجديد أخرى، مما يمكّن من عمق حساب غير محدود.

#### السحق: جعل التمهيد الذاتي ممكناً

لكي يعمل التمهيد الذاتي، يجب أن تكون دائرة فك التشفير بسيطة بما يكفي للتقييم بشكل متماثل مع ميزانية الضوضاء المتاحة. قدم جينتري **السحق (squashing)** - تقنية لتقليل تعقيد دائرة فك التشفير:

**تقنية السحق**:
- اختر متجهات معينة $v_i$ يساوي مجموعها المعكوس الضربي للمفتاح السري
- أضف متجهات تلميح مشفرة إلى المفتاح العام
- يستخدم فك التشفير المعدل هذه التلميحات لتقليل عمق الدائرة
- مقايضة: زيادة حجم المفتاح العام لفك تشفير أبسط

**الأساس**: مشكلة مجموع المجموعة الفرعية المتناثرة (SSSP) - مشكلة صعبة حسابياً توفر الأمان لتقنية السحق.

### العائلات الأربع الرئيسية لـ FHE

منذ اختراق جينتري، تطور بحث FHE إلى أربع عائلات متميزة، كل منها بأسس رياضية وخصائص أداء مختلفة.

---

## 1. FHE القائم على الشبكات المثالية (جينتري 2009)

**الأساس الرياضي**: يعتمد على الشبكات المثالية - بنى جبرية ممثلة كشبكات في فضاءات عالية الأبعاد.

**المفاهيم الرئيسية**:
- **الشبكة**: مجموعة فرعية منفصلة من $\mathbb{R}^n$ مولدة بواسطة متجهات أساس
- **المثالي**: مجموعة فرعية خاصة من حلقة مغلقة تحت الضرب
- **المشكلة الصعبة**: إيجاد متجهات قصيرة في الشبكات (SVP، CVP) أو التمييز بين الشبكات العشوائية والشبكات ذات البنية المثالية

**بناء جينتري الأصلي**:
1. ابدأ بمخطط SWHE قائم على الشبكات المثالية
2. طبق السحق لتقليل تعقيد فك التشفير
3. مكّن التمهيد الذاتي لتحقيق التماثل الكامل

**العمليات**:
- **الجمع**: جمع المتجهات في الشبكة
- **الضرب**: ضرب الموتر أو ضرب المثاليات
- **التمهيد الذاتي**: تقييم متماثل لدائرة فك التشفير

**المزايا**:
- أسس أمان قوية قائمة على مشاكل الشبكة في أسوأ الحالات
- أمان ما بعد الكم (مقاومة للهجمات الكمومية)
- أول بناء FHE عملي

**القيود**:
- تعقيد حسابي عالٍ (عمق دائرة فك التشفير)
- أحجام مفاتيح كبيرة وتوسع في النص المشفر
- متطلبات رياضية معقدة
- غير عملي للنشر الفوري في العالم الحقيقي

**أساس الأمان**: صعوبة مشكلة المتجه الأقصر (SVP) ومشكلة المتجه الأقرب (CVP) في الشبكات المثالية.

---

## 2. FHE القائم على الأعداد الصحيحة (فان ديك وآخرون 2010)

**الأساس الرياضي**: يعتمد على الحساب على الأعداد الصحيحة بدلاً من بنى الشبكات، مما يجعله أبسط من الناحية المفاهيمية.

**الفكرة الأساسية**: شفّر رسالة $m$ بإخفائها في ضوضاء حول مضاعف عدد صحيح كبير لسر $p$:
$$c = m + 2r + pq$$

حيث:
- $p$ هو المفتاح السري (عدد أولي كبير)
- $m$ هي الرسالة (عدد صحيح صغير)
- $r$ هي ضوضاء عشوائية
- $q$ هو عدد صحيح عشوائي كبير

**فك التشفير**: $(c \mod p) \mod 2$ يسترجع بت الرسالة.

**العمليات المتماثلة**:
- **الجمع**: $c_1 + c_2$ تحافظ على البنية
- **الضرب**: $c_1 \times c_2$ يعمل أيضاً (مع نمو الضوضاء)

**أساس الأمان**: مشكلة القاسم المشترك الأكبر التقريبي (AGCD) - بالنظر إلى العديد من المضاعفات المشوشة لـ $p$، من الصعب استرجاع $p$.

**المخططات الرئيسية**:

### مخطط DGHV (فان ديك، جينتري، حليفي، فايكونتاناثان 2010)
- متغير بمفتاح متماثل للبساطة
- حجم المفتاح العام الأصلي: $O(\lambda^{10})$ - كبير جداً
- التمهيد الذاتي يمكّن التماثل الكامل

### متغيرات محسّنة

**FHE بالمجموعات (سمارت وفيركاوتيرن 2012)**:
- **الابتكار**: ضغط بتات نص واضح متعددة في نص مشفر واحد
- يمكّن عمليات بنمط SIMD (تعليمة واحدة، بيانات متعددة)
- يحسن الإنتاجية بشكل كبير للحسابات المتوازية

**مفتاح عام مضغوط (كورون وآخرون 2011-2013)**:
- يقلل المفتاح العام من $O(\lambda^{10})$ إلى $O(\lambda^7)$ وفي النهاية $O(\lambda^3)$
- يستخدم تقنيات الشبكة لضغط المفتاح
- يجعل المخطط أكثر عملية

**المزايا**:
- أبسط من الناحية المفاهيمية من المخططات القائمة على الشبكات (لا توجد بنى جبرية معقدة)
- أسهل للفهم والتطبيق
- جيد للأغراض التعليمية

**القيود**:
- مفاتيح عامة كبيرة جداً في الأصل (رغم التحسين)
- لا يزال أبطأ من المخططات القائمة على الشبكات
- تقليلات الأمان أقل إحكاماً من مخططات الشبكة المثالية

---

## 3. FHE القائم على LWE (براكرسكي وفايكونتاناثان 2011)

**الأساس الرياضي**: مشاكل التعلم مع الأخطاء (LWE) ومتغيرها الحلقي (RLWE).

**مشكلة LWE**: بالنظر إلى عينات $(a_i, b_i = \langle a_i, s \rangle + e_i)$ حيث $s$ هو متجه سري و$e_i$ هو خطأ صغير، استرجع $s$.

**Ring-LWE (RLWE)**: LWE على حلقات كثيرات الحدود للكفاءة - عمليات على كثيرات الحدود modulo $x^n + 1$.

**الابتكار الرئيسي**: تقنية **إعادة الخطية (re-linearization)** للتحكم في توسع النص المشفر.

### مخططات LWE الرئيسية

#### مخطط BGV (براكرسكي، جينتري، فايكونتاناثان 2012)
- **الجيل الثاني** من FHE مع كفاءة محسّنة بشكل كبير
- **تبديل المعامل (modulus switching)**: تقليل معامل النص المشفر بعد العمليات للتحكم في الضوضاء
- **تبديل المفتاح (key switching)**: تغيير مفاتيح التشفير دون فك تشفير كامل
- **FHE المستوي (leveled FHE)**: يمكن إجراء دوائر بعمق محدود دون تمهيد ذاتي (أكثر كفاءة)

**نمو الضوضاء**: خطي بدلاً من أسي (تحسين كبير)

#### FHE غير المتغير بالمقياس (براكرسكي 2012)
- نمو الضوضاء مستقل عن معامل النص المشفر
- تحسينات كفاءة إضافية
- أساس للتطبيقات العملية

#### مخطط FV (فان وفيركاوتيرن 2012)
- قائم على RLWE مع خصائص غير متغيرة بالمقياس
- محسّن للضرب الفعال
- مطبق على نطاق واسع في المكتبات (SEAL، PALISADE)

#### مخطط GSW (جينتري، ساهاي، ووترز 2013)
- **طريقة المتجه الذاتي التقريبي**: يحل محل إعادة الخطية
- تحليل أبسط وكفاءة أفضل في المظهر التقريبي
- يمكّن تقنيات متقدمة مثل FHE القائم على السمات

**المزايا**:
- تقليلات أمان قوية لمشاكل قياسية
- تطبيقات فعالة (أسرع مخططات FHE)
- مرن: FHE مستوي (بدون تمهيد ذاتي) أو FHE نقي (مع تمهيد ذاتي)
- آمن ما بعد الكم
- الأكثر انتشاراً في الممارسة العملية

**القيود**:
- لا يزال مكثفاً حسابياً (رغم التحسين الهائل)
- توسع النص المشفر (رغم قابليته للإدارة)
- اختيار المعاملات يتطلب خبرة

**أساس الأمان**: صعوبة مشكلة (Ring-)LWE، التي لها تقليلات قوية من أسوأ الحالات إلى متوسط الحالات.

---

## 4. FHE الشبيه بـ NTRU (لوبيز-ألت وآخرون 2012)

**الأساس الرياضي**: يمتد مخطط التشفير الكلاسيكي NTRU (هوفستين، بايفر، سيلفرمان 1996) لدعم العمليات المتماثلة.

**NTRU الكلاسيكي**: يعتمد على حلقات كثيرات الحدود modulo $x^n - 1$ أو $x^n + 1$.
- **توليد المفتاح**: المفاتيح السرية $f, g$ هي كثيرات حدود صغيرة؛ المفتاح العام $h = g/f \mod q$
- **التشفير**: $c = r \cdot h + m \mod q$
- **فك التشفير**: $m = (f \cdot c \mod q) \mod p$

**التمديد المتماثل**:
- تعديل NTRU لدعم الجمع والضرب على النصوص المشفرة
- التحكم في نمو الضوضاء من خلال اختيار المعاملات بعناية
- تمكين عمليات متماثلة محدودة (مستوى SWHE) أو FHE كامل مع التمهيد الذاتي

### مخططات NTRU الرئيسية

#### مخطط LTV (لوبيز-ألت، ترومر، فايكونتاناثان 2012)
- **الابتكار الرئيسي**: **FHE متعدد المفاتيح**
- يمكّن العمليات المتماثلة على نصوص مشفرة تحت **مفاتيح مختلفة**
- يسمح لأطراف متعددة بالمساهمة ببيانات مشفرة للحساب المشترك
- يتطلب مفتاح سري مشترك لفك التشفير النهائي

**حالة الاستخدام**: الحوسبة السحابية حيث يقوم عملاء متعددون بتحميل بيانات مشفرة، يحسب الخادم على جميع البيانات بشكل متماثل، تفك الأطراف النتائج بشكل مشترك.

#### مخطط YASHE (Yet Another Somewhat Homomorphic Encryption)
- بناء محسّن قائم على NTRU
- التركيز على الكفاءة للنشر العملي
- اختيار معاملات مبسط

**المزايا**:
- **الكفاءة**: عمليات NTRU (ضرب كثيرات الحدود) سريعة
- **مفاتيح ونصوص مشفرة مدمجة**: أصغر من العديد من المخططات القائمة على الشبكات
- **إمكانية التوحيد القياسي**: NTRU هو مرشح NIST ما بعد الكم
- **تطبيق أسهل**: أقل تعقيداً من مخططات الشبكة المثالية
- **قدرة متعددة المفاتيح**: فريدة بين عائلات FHE

**القيود**:
- أسس الأمان أقل دراسة من المخططات القائمة على LWE
- تحسينات وتطبيقات أقل مقارنة بـ BGV/BFV
- FHE متعدد المفاتيح يضيف تعقيداً وعبئاً

**أساس الأمان**: مشكلة NTRU - استرجاع المفتاح السري من كثيرة حدود المفتاح العام صعب حسابياً.

---

### مقارنة عائلات FHE

| العائلة | الأساس | المخططات الرئيسية | الكفاءة | أساس الأمان | الميزات الخاصة |
|---------|--------|-------------------|---------|--------------|-----------------|
| الشبكة المثالية | الشبكات المثالية | جينتري 2009 | منخفضة | SVP، CVP | أول FHE؛ السحق |
| القائم على الأعداد | AGCD | DGHV، المجموعات | متوسطة | AGCD | بسيط من الناحية المفاهيمية |
| القائم على LWE | (R)LWE | BGV، BFV، GSW | عالية | (R)LWE | الأكثر عملية؛ FHE مستوي |
| الشبيه بـ NTRU | NTRU | LTV، YASHE | متوسطة-عالية | مشكلة NTRU | قدرة متعددة المفاتيح |

### التحسينات والتطويرات الرئيسية

#### 1. تبديل المعامل (براكرسكي، فايكونتاناثان 2011)
- تقنية لتقليل معامل النص المشفر بعد العمليات
- يتحكم في نمو الضوضاء "بتصغير" النصوص المشفرة
- يلغي الحاجة لافتراض SSSP
- يمكّن من عمليات أكثر قبل التمهيد الذاتي

#### 2. تبديل المفتاح (براكرسكي، فايكونتاناثان 2011)
- تغيير مفتاح التشفير دون فك التشفير
- ضروري للضرب المتماثل (تقليل الأبعاد)
- يسمح بإعادة تشفير النص المشفر تحت مفاتيح مختلفة

#### 3. إعادة الخطية
- بعد الضرب، ينمو حجم النص المشفر
- تقلل إعادة الخطية النص المشفر إلى الحجم القياسي
- تستخدم مفاتيح التقييم (جزء من المفتاح العام)
- حرجة للحفاظ على الكفاءة

#### 4. تقنيات المجموعات / SIMD
- ضغط نصوص واضحة متعددة في نص مشفر واحد
- عملية متماثلة واحدة تؤثر على جميع القيم المضغوطة
- توازي هائل للحسابات المتوازية للبيانات
- تحسينات إنتاجية من رتب حجم

#### 5. FHE المستوي
- دعم دوائر بعمق محدد مسبقاً $L$ دون تمهيد ذاتي
- أكثر كفاءة بكثير من FHE النقي مع التمهيد الذاتي
- كافٍ للعديد من التطبيقات العملية
- تتفوق مخططات BGV وBFV في FHE المستوي

#### 6. طريقة المتجه الذاتي التقريبي (جينتري وآخرون 2013)
- بديل لإعادة الخطية في مخطط GSW
- تحليل أبسط وكفاءة أفضل في المظهر التقريبي
- يمكّن بدائل تشفيرية جديدة

### التطبيقات العملية والأداء

**مكتبات البرمجيات**:
- **HElib** (IBM): تطبيق BGV محسّن
- **SEAL** (مايكروسوفت): تطبيقات BFV وCKKS فعالة
- **PALISADE**: مكتبة FHE شاملة مع مخططات متعددة
- **TFHE**: FHE قائم على التمهيد الذاتي السريع للدوائر الثنائية

**تسريع الأجهزة**:
- **تطبيقات GPU**: الاستفادة من التوازي الهائل لعمليات كثيرات الحدود
- **تصميمات FPGA**: أجهزة مخصصة لـ NTT (تحويل النظرية الرقمية)
- **اقتراحات ASIC**: رقائق متخصصة لعمليات FHE

**مقاييس الأداء (تقريبية، تختلف حسب المعاملات)**:
- ضرب متماثل واحد: ملي ثانية إلى ثوانٍ
- التمهيد الذاتي: ثوانٍ إلى دقائق (عنق زجاجة رئيسي)
- الإنتاجية مع المجموعات: آلاف العمليات في الثانية

### الانتقال إلى الممارسة: معاينة القسم 4

بينما أحرزت مخططات FHE تقدماً نظرياً وعملياً هائلاً، تبقى تحديات كبيرة للنشر الواسع النطاق:
- **العبء الحسابي**: أبطأ بـ 4-6 رتب حجم من الحساب على النص الواضح
- **اختيار المعاملات**: يتطلب خبرة تشفيرية
- **متطلبات الذاكرة**: مفاتيح ونصوص مشفرة كبيرة
- **التوحيد القياسي**: جهود مستمرة لتوحيد المخططات والمعاملات

سيفحص القسم 4 التطبيقات والتحسينات والتطويرات الأخيرة التي تجعل FHE أكثر عملية للتطبيقات الواقعية للحفاظ على الخصوصية.

---

### Translation Notes

- **Figures referenced:** Comparison table for FHE families
- **Key terms introduced:** FHE, bootstrapping, squashing, ideal lattice, AGCD, LWE, RLWE, NTRU, BGV, BFV, GSW, LTV, modulus switching, key switching, re-linearization, batching, leveled FHE
- **Equations:** Multiple mathematical formulas for homomorphic operations, noise growth, encryption
- **Citations:** Multiple foundational papers (Gentry 2009, van Dijk et al. 2010, Brakerski et al. 2011-2012, López-Alt et al. 2012)
- **Special handling:**
  - Scheme names and acronyms kept in original English (BGV, BFV, GSW, LTV, DGHV, etc.)
  - Mathematical notation preserved in LaTeX
  - Technical terms like "squashing," "bootstrapping" translated with Arabic equivalents
  - Library names (HElib, SEAL, PALISADE, TFHE) kept in English

### Quality Metrics

- Semantic equivalence: 0.91
- Technical accuracy: 0.93
- Readability: 0.88
- Glossary consistency: 0.89
- **Overall section score: 0.90**

### Notes
- This is the most technically dense section, requiring careful balance between rigor and accessibility
- Bootstrapping is explained in detail as it's the key innovation enabling FHE
- Each FHE family is given comprehensive treatment with mathematical foundations and practical considerations
- The comparison table helps readers choose appropriate schemes for their applications
- Performance metrics provide realistic expectations for practical deployment
