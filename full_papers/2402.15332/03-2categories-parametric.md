# Section 3: 2-Categories and Parametric Morphisms
## القسم 3: الفئات الثنائية والتشاكلات البارامترية

**Section:** 2-categories-parametric-morphisms
**Translation Quality:** 0.88
**Glossary Terms Used:** 2-category, parametric morphism, monad, natural transformation, weight tying, reparameterization, lax algebra, neural network

---

### English Version

## 3. 2-Categories and Parametric Morphisms

While category theory is a powerful framework, it leaves much to be desired in terms of higher-order relationships between morphisms. It only deals with sets of morphisms, with no possible way to compare elements of these sets. This is where the theory of 2-categories comes in, which deals with an entire category of morphisms. While in a (1-)category, one has objects and morphisms between objects, in a 2-category one has objects (known as 0-morphisms), morphisms between objects (1-morphisms), and morphisms between morphisms (2-morphisms). We have, in fact, already secretly seen an instance of a 2-category, Cat, when defining the essential concepts of category theory. Specifically, in Cat, objects are categories, morphisms are functors between them, and 2-morphisms are natural transformations between functors.

### 3.1 The 2-category Para

In this section we define an established 2-category Para (Cruttwell et al., 2022; Capucci et al., 2022), and proceed to unpack the manner which we posit weight sharing can be modelled formally in it.

While it shares objects with the category Set, its 1-morphisms are not functions, but parametric functions. That is, a 1-morphism A → B here consists of a pair (P, f), where P ∈ Set and f : P × A → B.

Para morphisms admit an elegant graphical formalism. Parameters (P) are drawn vertically, signifying that they are part of the morphism, and not objects.

The 2-category Para models the algebra of composition of neural networks; the sequential composition of parametric morphisms composes the parameter spaces in parallel.

The 2-morphisms in Para capture reparameterisations between parametric functions. Importantly, this allows for the explicit treatment of weight tying, where a parametric morphism (P × P, f) can have its weights tied by precomposing with the copy map Δ_P : P → P × P.

This 2-category is one of the key components in the categorical picture of gradient-based learning (Cruttwell et al., 2022). But we hypothesise that more is true:

**Position:** It is our position that the 2-category Para and 2-categorical algebra valued in it provide a formal theory of neural network architectures, establish formal criteria for weight tying correctness and inform design of new architectures.

### 3.2 2-dimensional Categorical Algebra

2-category theory is markedly richer than 1-category theory. While diagrams in a 1-category either commute or do not commute, in a 2-category, they serve as a 1-skeleton to which 2-morphisms attach. In any 2-category a square may: commute, pseudo-commute, lax-commute, or oplax commute, meaning, respectively, that relevant paths are equal, isomorphic, or there is a 2-morphism from one to the other in one direction or the other.

In the long run, we expect that all of these notions will apply to, either explaining or specifying, aspects of neural architecture past, present and future. Focusing on just one of them, the lax algebras are sufficient to derive recursive, recurrent, and similar neural networks from first principles. Notably, morphisms of lax algebras are also expressive enough to capture 1-cocycles, used to formalise asynchronous neural networks.

For all the examples of endofunctors in Section 2.2, there is a monad whose category of algebras FreeMnd(F) is equivalent to the category of algebras for the original endofunctor F. We obtain FreeMnd(F) by iterating F until it stabilises. This concept connects endofunctor algebras to monad algebras.

But in the 2-dimensional case, we study the relationship between Lax-Alg_Endo(F) and Lax-Alg_Mnd(FreeMnd(F)) and need contend not only with generating the 1-dimensional structure map, but also the 2-cells of the lax algebra for a monad.

To reconcile this with concrete applications, we note that we do not need to study general 2-endofunctors and 2-monads on Para. Rather, examples which concern us arise from specific 1-categorical algebras (group action monads, inductive types, etc.), which are augmented into 2-monads on Para. As we prove in Theorem G.10, the lax cells of such algebras are actually **comonoids**. The fact that we can duplicate or delete entries in vectors—the essence of tying weights—is the informal face of this comonoid structure.

We can now describe, even if space constraints prevent us from adequate level of detail, the universal properties of recurrent, recursive, and similar models: they are **lax algebras for free parametric monads generated by parametric endofunctors**! Having lifted the concept of algebra introduced in Part 2 into 2-categories, we can now describe several influential neural networks fully (not just their individual layers!) from first principles of functional programming.

---

### النسخة العربية

## 3. الفئات الثنائية والتشاكلات البارامترية

بينما تُعد نظرية الفئات إطار عمل قوياً، فإنها تترك الكثير مما هو مرغوب فيه من حيث العلاقات عالية الرتبة بين التشاكلات. فهي تتعامل فقط مع مجموعات التشاكلات، دون أي طريقة ممكنة لمقارنة عناصر هذه المجموعات. هنا يأتي دور نظرية الفئات الثنائية، التي تتعامل مع فئة كاملة من التشاكلات. بينما في فئة (1-)، يكون لدينا كائنات وتشاكلات بين الكائنات، في فئة ثنائية يكون لدينا كائنات (تُعرف بالتشاكلات-0)، وتشاكلات بين الكائنات (تشاكلات-1)، وتشاكلات بين التشاكلات (تشاكلات-2). في الواقع، رأينا بالفعل سراً مثالاً على فئة ثنائية، Cat، عند تعريف المفاهيم الأساسية لنظرية الفئات. على وجه التحديد، في Cat، الكائنات هي فئات، والتشاكلات هي دوال وظيفية بينها، والتشاكلات-2 هي تحويلات طبيعية بين الدوال الوظيفية.

### 3.1 الفئة الثنائية Para

في هذا القسم نعرّف فئة ثنائية راسخة Para (Cruttwell et al., 2022; Capucci et al., 2022)، ونواصل فك الطريقة التي نفترض أن مشاركة الأوزان يمكن نمذجتها رسمياً فيها.

بينما تشارك الكائنات مع الفئة Set، فإن تشاكلاتها-1 ليست دوال، بل دوال بارامترية. أي، أن تشاكل-1 من A → B هنا يتكون من زوج (P, f)، حيث P ∈ Set وf : P × A → B.

تسمح تشاكلات Para بشكلية رسومية أنيقة. البارامترات (P) تُرسم عمودياً، للإشارة إلى أنها جزء من التشاكل، وليست كائنات.

تنمذج الفئة الثنائية Para جبر تركيب الشبكات العصبية؛ التركيب التسلسلي للتشاكلات البارامترية يركب فضاءات البارامترات بالتوازي.

تلتقط التشاكلات-2 في Para إعادات البارمترة بين الدوال البارامترية. الأهم من ذلك، أن هذا يسمح بالمعالجة الصريحة لربط الأوزان، حيث يمكن لتشاكل بارامتري (P × P, f) أن يكون له أوزانه مربوطة بالتركيب المسبق مع خريطة النسخ Δ_P : P → P × P.

هذه الفئة الثنائية هي أحد المكونات الرئيسية في الصورة الفئوية للتعلم القائم على التدرج (Cruttwell et al., 2022). لكننا نفترض أن المزيد صحيح:

**الموقف:** موقفنا هو أن الفئة الثنائية Para والجبر الفئوي الثنائي المقيّم فيها يوفران نظرية رسمية لمعماريات الشبكات العصبية، ويؤسسان معايير رسمية لصحة ربط الأوزان ويُعلمان تصميم معماريات جديدة.

### 3.2 الجبر الفئوي ثنائي الأبعاد

نظرية الفئات الثنائية أكثر ثراءً بشكل ملحوظ من نظرية الفئات الأحادية. بينما المخططات في فئة أحادية إما تتبادل أو لا تتبادل، في فئة ثنائية، فإنها تعمل كهيكل-1 تُرفق به التشاكلات-2. في أي فئة ثنائية، قد يكون المربع: متبادلاً، أو شبه-متبادلاً، أو متساهل-متبادلاً، أو عكس-متساهل-متبادلاً، مما يعني، على التوالي، أن المسارات ذات الصلة متساوية، أو متماثلة، أو يوجد تشاكل-2 من أحدها إلى الآخر في اتجاه أو آخر.

على المدى الطويل، نتوقع أن كل هذه المفاهيم ستنطبق على، إما شرح أو تحديد، جوانب من المعمارية العصبية الماضية والحاضرة والمستقبلية. بالتركيز على واحدة منها فقط، فإن الجبور المتساهلة كافية لاشتقاق الشبكات العصبية التكرارية والمتكررة والمشابهة من المبادئ الأولى. والجدير بالذكر، أن تشاكلات الجبور المتساهلة معبّرة بما يكفي أيضاً للتقاط دورات-1، المستخدمة لإضفاء الطابع الرسمي على الشبكات العصبية اللامتزامنة.

لجميع الأمثلة على الدوال الوظيفية الذاتية في القسم 2.2، يوجد موناد تكون فئة جبوره FreeMnd(F) مكافئة لفئة جبور الدالة الوظيفية الذاتية الأصلية F. نحصل على FreeMnd(F) بتكرار F حتى تستقر. يربط هذا المفهوم جبور الدوال الوظيفية الذاتية بجبور الموناد.

ولكن في الحالة ثنائية الأبعاد، ندرس العلاقة بين Lax-Alg_Endo(F) وLax-Alg_Mnd(FreeMnd(F)) ونحتاج إلى التعامل ليس فقط مع توليد خريطة البنية أحادية البعد، ولكن أيضاً الخلايا-2 للجبر المتساهل لموناد.

لتسوية هذا مع التطبيقات الملموسة، نلاحظ أننا لا نحتاج لدراسة الدوال الوظيفية الذاتية-2 والموناد-2 العامة على Para. بدلاً من ذلك، تنشأ الأمثلة التي تهمنا من جبور فئوية-1 محددة (موناد أفعال المجموعات، الأنواع الاستقرائية، إلخ.)، والتي يتم تعزيزها إلى موناد-2 على Para. كما نثبت في المبرهنة G.10، فإن الخلايا المتساهلة لمثل هذه الجبور هي في الواقع **أحاديات مرافقة**. حقيقة أننا يمكننا تكرار أو حذف إدخالات في المتجهات—جوهر ربط الأوزان—هو الوجه غير الرسمي لهذه البنية الأحادية المرافقة.

يمكننا الآن وصف، حتى لو منعتنا قيود المساحة من مستوى كافٍ من التفصيل، الخصائص الشاملة للنماذج المتكررة والتكرارية والمشابهة: فهي **جبور متساهلة لموناد بارامترية حرة مولدة بواسطة دوال وظيفية ذاتية بارامترية**! بعد رفع مفهوم الجبر المُقدّم في الجزء 2 إلى الفئات الثنائية، يمكننا الآن وصف عدة شبكات عصبية مؤثرة بالكامل (ليس فقط طبقاتها الفردية!) من المبادئ الأولى للبرمجة الوظيفية.

---

### Translation Notes

- **Key terms:**
  - 2-category (فئة ثنائية)
  - Parametric morphism (تشاكل بارامتري)
  - Weight tying (ربط الأوزان)
  - Reparameterization (إعادة البارمترة)
  - Lax algebra (جبر متساهل)
  - Comonoid (أحادي مرافق)
  - Free monad (موناد حر)

- **Graphical notation:** String diagrams mentioned but not fully shown
- **Equations:** Mathematical notation preserved
- **Theorem reference:** G.10 referenced from appendix

### Quality Metrics

- Semantic equivalence: 0.89
- Technical accuracy: 0.90
- Readability: 0.86
- Glossary consistency: 0.88
- **Overall section score:** 0.88

### Notes on Translation Choices

1. "2-category" → "فئة ثنائية" (2-dimensional category)
2. "Parametric morphism" → "تشاكل بارامتري" (morphism with parameters)
3. "Weight tying" → "ربط الأوزان" (literally "tying weights")
4. "Lax algebra" → "جبر متساهل" (algebra with weakened conditions)
5. "Comonoid" → "أحادي مرافق" (co-monoid, dual to monoid)
6. Preserved mathematical precision while maintaining readability
7. Position statement highlighted as key claim
